<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leslie's Food List</title>
<style>
  :root {
    --accent: #f57c00;
    --bg: #121212;
  }

  body {
    font-family: 'Segoe UI', sans-serif;
    padding: 20px;
    background: var(--bg);
    color: #ffffff;
    max-width: 500px;
    margin: auto;
  }

  h2 {
    text-align: center;
    font-size: 2.2rem;
    background: linear-gradient(45deg, #fbc02d, #f57c00);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 25px;
    font-weight: 800;
  }

  /* Rounded & Spaced Bars */
  #search, #foodName {
    width: 100%;
    padding: 14px 22px;
    border-radius: 30px;
    border: none;
    background: white;
    color: black;
    margin-bottom: 20px; /* Space between bars */
    box-sizing: border-box;
    font-size: 16px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.4);
  }

  #filterPanel {
    display: none;
    margin-bottom: 15px;
    background: #222;
    padding: 12px;
    border-radius: 15px;
  }

  .input-row {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
  }

  input, select {
    border-radius: 10px;
    border: none;
    padding: 10px;
  }

  #ingredientName { flex: 2; background: white; color: black; }
  #quantity { width: 65px; background: white; color: black; }
  #unit { flex: 1; background: white; color: black; }

  button {
    border-radius: 10px;
    cursor: pointer;
    border: none;
    font-weight: bold;
    transition: all 0.2s;
  }

  #addIngredientBtn {
    background: #fbc02d;
    color: #000;
    width: 100%;
    padding: 12px;
    margin-bottom: 15px;
  }

  #saveFoodBtn {
    background: #f57c00;
    color: white;
    width: 100%;
    padding: 16px;
    font-size: 16px;
  }

  .ing-chip {
    display: inline-block;
    background: #333;
    padding: 6px 14px;
    border-radius: 20px;
    margin: 4px;
    font-size: 13px;
    border: 1px solid #555;
  }

  .food-card {
    margin-top: 25px;
    padding: 18px;
    border-radius: 20px;
    color: #1a1a1a;
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
  }

  .ingredients-box {
    background: rgba(255, 255, 255, 0.4);
    padding: 12px;
    border-radius: 12px;
    margin: 12px 0;
    white-space: pre-line;
  }

  .card-btns { display: flex; gap: 8px; }
  .copy-btn { background: #1976d2; color: white; flex: 2; padding: 10px; }
  .edit-btn { background: #388e3c; color: white; padding: 10px; }
  .delete-btn { background: #d32f2f; color: white; padding: 10px; }
</style>
</head>
<body>

<h2>Leslie's Food List</h2>

<input id="search" placeholder="ðŸ” Search foods..." oninput="render()">

<div style="text-align: right;">
  <button onclick="toggleFilters()" style="background:none; color:#fbc02d; font-size:12px; margin-bottom:10px;">Options â–¾</button>
</div>

<div id="filterPanel">
  <select id="sortName" onchange="render()" style="width:100%; margin-bottom:8px;">
    <option value="az">A to Z</option>
    <option value="za">Z to A</option>
  </select>
  <select id="sortDate" onchange="render()" style="width:100%;">
    <option value="newest">Newest First</option>
    <option value="oldest">Oldest First</option>
  </select>
</div>

<input id="foodName" placeholder="Dish name (e.g., Pizza)">

<div class="input-row">
  <input id="ingredientName" list="ingredientSuggestions" placeholder="Ingredient">
  <datalist id="ingredientSuggestions"></datalist>
  
  <input id="quantity" type="number" value="1">
  <select id="unit">
    <option value="">unit</option>
    <option value="pc">pc</option>
    <option value="pack">pack</option>
    <option value="tin">tin</option>
    <option value="bottle">bottle</option>
  </select>
</div>

<button id="addIngredientBtn" onclick="addIngredient()">+ Add Ingredient</button>
<div id="tempIngList"></div>

<input id="foodDate" type="date" style="width: 100%; box-sizing: border-box; margin-bottom: 15px;">

<button id="saveFoodBtn" onclick="addFood()">Save Food</button>

<div id="foodList"></div>

<script>
let foods = JSON.parse(localStorage.getItem('foods')) || [];
let tempIngredients = [];
let editingId = null;

function save() {
  localStorage.setItem('foods', JSON.stringify(foods));
  updateSuggestions();
}

function toggleFilters() {
  const p = document.getElementById('filterPanel');
  p.style.display = p.style.display === 'block' ? 'none' : 'block';
}

function randomColor() {
  const colors = ['#FFD1DC', '#D1FFD7', '#D1E8FF', '#FFF0D1', '#E8D1FF', '#D1FFF0', '#F3FFE3'];
  return colors[Math.floor(Math.random() * colors.length)];
}

function updateSuggestions() {
  const datalist = document.getElementById('ingredientSuggestions');
  // Get all unique ingredient names from the saved foods
  const allNames = [...new Set(foods.flatMap(f => f.ingredients.map(i => i.name)))];
  
  datalist.innerHTML = '';
  allNames.forEach(name => {
    const option = document.createElement('option');
    option.value = name;
    datalist.appendChild(option);
  });
}

function addIngredient() {
  const nameInput = document.getElementById('ingredientName');
  const name = nameInput.value.trim();
  const qty = document.getElementById('quantity').value;
  const unit = document.getElementById('unit').value;
  
  if (!name) return;
  
  tempIngredients.push({ name, qty, unit });
  nameInput.value = '';
  renderTemp();
}

function renderTemp() {
  const container = document.getElementById('tempIngList');
  container.innerHTML = tempIngredients.map((ing, i) => `
    <span class="ing-chip">${ing.qty}${ing.unit} ${ing.name} 
      <b style="color:red; cursor:pointer; margin-left:5px" onclick="removeTemp(${i})">Ã—</b>
    </span>
  `).join('');
}

function removeTemp(i) {
  tempIngredients.splice(i, 1);
  renderTemp();
}

function addFood() {
  const name = document.getElementById('foodName').value.trim();
  const date = document.getElementById('foodDate').value;

  if (!name || tempIngredients.length === 0) {
    alert("Missing name or ingredients!");
    return;
  }

  if (editingId !== null) {
    const idx = foods.findIndex(f => f.id === editingId);
    if (idx !== -1) {
      foods[idx].name = name;
      foods[idx].ingredients = [...tempIngredients];
      foods[idx].date = date || 'No date';
    }
    editingId = null;
    document.getElementById('saveFoodBtn').innerText = "Save Food";
  } else {
    foods.push({
      id: Date.now(),
      name,
      ingredients: [...tempIngredients],
      date: date || 'No date',
      color: randomColor()
    });
  }

  tempIngredients = [];
  document.getElementById('foodName').value = '';
  document.getElementById('foodDate').value = '';
  renderTemp();
  save();
  render();
}

function copyToClipboard(foodId) {
  const food = foods.find(f => f.id === foodId);
  if (!food) return;
  
  const ingString = food.ingredients.map(i => `â€¢ ${i.qty}${i.unit} ${i.name}`).join('\n');
  const text = `${food.name}\n${ingString}`;
  
  navigator.clipboard.writeText(text).then(() => {
    alert("Copied!");
  }).catch(() => {
    // Fallback for older browsers
    const el = document.createElement('textarea');
    el.value = text;
    document.body.appendChild(el);
    el.select();
    document.execCommand('copy');
    document.body.removeChild(el);
    alert("Copied!");
  });
}

function deleteFood(id) {
  if (confirm("Delete this food?")) {
    foods = foods.filter(f => f.id !== id);
    save();
    render();
  }
}

function editFood(id) {
  const food = foods.find(f => f.id === id);
  if (!food) return;

  document.getElementById('foodName').value = food.name;
  document.getElementById('foodDate').value = food.date === 'No date' ? '' : food.date;
  tempIngredients = [...food.ingredients];
  
  editingId = id;
  document.getElementById('saveFoodBtn').innerText = "Update This Food";
  
  renderTemp();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function render() {
  const listDiv = document.getElementById('foodList');
  const query = document.getElementById('search').value.toLowerCase();
  const sortN = document.getElementById('sortName').value;
  const sortD = document.getElementById('sortDate').value;

  let filtered = foods.filter(f => f.name.toLowerCase().includes(query));

  filtered.sort((a, b) => {
    return sortN === 'az' ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name);
  });

  filtered.sort((a, b) => {
    const da = new Date(a.date).getTime() || 0;
    const db = new Date(b.date).getTime() || 0;
    return sortD === 'newest' ? db - da : da - db;
  });

  listDiv.innerHTML = '';

  filtered.forEach(food => {
    const card = document.createElement('div');
    card.className = 'food-card';
    card.style.backgroundColor = food.color;

    const ingString = food.ingredients.map(i => `â€¢ ${i.qty}${i.unit} ${i.name}`).join('\n');
    
    card.innerHTML = `
      <strong>${food.name}</strong>
      <span style="font-size:0.8rem; opacity:0.7;">ðŸ“… ${food.date}</span>
      <div class="ingredients-box">${ingString}</div>
      <div class="card-btns">
        <button class="copy-btn" onclick="copyToClipboard(${food.id})">Copy</button>
        <button class="edit-btn" onclick="editFood(${food.id})">Edit</button>
        <button class="delete-btn" onclick="deleteFood(${food.id})">Delete</button>
      </div>
    `;
    listDiv.appendChild(card);
  });
}

// Initial Run
updateSuggestions();
render();
</script>

</body>
</html>
